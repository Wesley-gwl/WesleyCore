function errorHandler(n) { n.status == 401 ? (alert("登录超时或身份验证错误,请重新登录!"), top.location.href = "/Home/Login") : n.status == 403 ? alert("你没有权限!") : n.status == 0 ? console.log({ xhr: n, message: "xhr异常关闭" }) : console.log("服务器错误： " + n.status + " " + n.statusText) } function showPopupWindow(n, t, i, r) { layer.open({ type: 2, title: n || "标题", shade: .1, area: [i || "800px", r || "600px"], content: t || "/Home/Error" }) } function closePopupWindow() { layer.closeAll("iframe") } function getRootPath() { var n = window.document.location.href, r = window.document.location.pathname, t, i; return t = n.indexOf("http") == 0 ? n.substr(7).indexOf(r) + 7 : n.substring(0, t), i = n.substring(0, t), i + "/" } function getRootPathName() { return window.document.location.pathname } function getCurrentPath() { var n = window.document.location.href, t = window.document.location.pathname, i, r, u; return i = n.indexOf("http") == 0 ? n.substr(7).indexOf(t) + 7 : n.substring(0, i), r = n.substring(0, i), u = t.substring(0, t.substr(1).indexOf("/") + 1), r + u } function HasSbc(n) { if (n = n.replace(":", ""), n == "") return !0; return /^[\w\u4e00-\u9fa5\uf900-\ufa2d()（）-]*$/.test(n) ? !1 : !0 } function InLength(n, t) { return t ? n.length > t ? !1 : !0 : !0 } function IsDecimal(n) { var i = new RegExp(/^\d*\.?\d*$/), t; return i.test(n) ? (t = n.indexOf("."), t == 0 || t + 1 == n.length ? !1 : !0) : !1 } function IsNumber(n) { return /^[01233456789]{1,}$/.test(n) ? !0 : !1 } function IsValidNum(n) { return n.trim() == "" ? !1 : isNaN(n) ? !1 : parseFloat(n) <= 0 ? !1 : !0 } function IsTel(n) { return /[\d|-]{7,15}/.test(n) ? !0 : !1 } function IsEmail(n) { return /^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test(n) ? !0 : !1 } function IsMobile(n) { return /^^(13[0-9]|14[5|7]|15[0|1|2|3|5|6|7|8|9]|18[0|1|2|3|5|6|7|8|9])\d{8}$/.test(n) ? !0 : !1 } function strToDate(n) { if (!n) return null; var t = /(\d{4}).(\d{2}).(\d{2})[^\d\n]*(?:(\d{2}))?(?:.(\d{2}))?(?:.(\d{2}))?/.exec(n); if (t != null) return new Date(t[1], t[2] - 1, t[3], t[4], t[5], t[6]) } function trim() { return arguments.length < 1 ? null : typeof arguments[0] == "string" ? arguments[0].replace(/(^[\s　]*)|([\s　]*$)/g, "") : "" } function ltrim() { return arguments.length < 1 ? null : typeof arguments[0] == "string" ? arguments[0].replace(/(^[\s　]*)/g, "") : "" } function rtrim() { return arguments.length < 1 ? null : typeof arguments[0] == "string" ? arguments[0].replace(/([\s　]*$)/g, "") : "" } function queryArray(n, t, i) { var r = -1; return $.each(n, function (n, u) { if (u && u[t] && u[t] == i) return r = n, !1 }), r } function queryArrayText(n, t) { var i = ""; return $.each(n, function (n, r) { r && t == r && (i = n) }), i } function queryArrayData(n, t, i) { var r = []; return $.each(n, function (n, u) { u && u[t] && u[t].indexOf(i) >= 0 && r.push(u) }), r } function loading(n, t) { if (__ishow != n) { if (__ishow = n, t = "", $("#loading") == undefined || $("#loading").css("display") == null) { var i = '<div id="loading"/>'; i += '<div id="loadimg">' + t + "<\/div>"; i += '<div id="loadifr"><iframe width="100%" scrolling="no" height="100%" frameborder="0"><\/iframe><\/div>'; $(document.body).append(i) } n == !0 ? ($("#loading").fadeTo("slow", .1), $("#loadimg").css("display", "block").animate("slow"), $("#loadifr").fadeTo("slow", .1)) : ($("#loading").css("display", "none"), $("#loadimg").css("display", "none"), $("#loadifr").css("display", "none")); GoTop() } } function GetFormatterButton(n, t, i, r) { return "<a href='javascript:" + r + "(" + i + ")' title='" + n + "'><i class='" + t + "'><\/i>" + n + "<\/a>" } function MouseButton(n) { return "<div class='" + n + "'>默认地址<div>" } function GetMouseButton(n, t, i, r, u) { return "<a class='" + u + "' href='javascript:" + r + "(" + i + ")' title='" + n + "'><i class='" + t + "'><\/i>" + n + "<\/a>" } function GoTop() { typeof parent.GoTopParent != "undefined" && parent.GoTopParent(); $("html,body").animate({ scrollTop: 0 }, 500) } function setCookie(n, t, i) { delCookie(n); var r = new Date; r.setTime(r.getTime() + i * 864e5); document.cookie = n + "=" + encodeURIComponent(t) + ";expires=" + r.toGMTString() + "; path=/;" } function getCookie(n) { var t, i = new RegExp("(^| )" + n + "=([^;]*)(;|$)"); return (t = document.cookie.match(i)) ? decodeURIComponent(t[2]) : null } function delCookie(n) { var t = new Date, i; t.setTime(t.getTime() - 1); i = getCookie(n); i != null && (document.cookie = n + "=" + i + ";expires=" + t.toGMTString()) } function PreviewImage(n, t, i) { var e, r, f, s; if (!(n.files.length <= 0)) { var o = ".jpg,.bmp,.gif,.png", h = n.value.substring(n.value.lastIndexOf(".") + 1).toLowerCase(), u = window.navigator.userAgent.toUpperCase(); o.indexOf(h) > -1 ? n.files ? window.FileReader ? (e = new FileReader, e.onload = function (n) { document.getElementById(t).setAttribute("src", n.target.result) }, e.readAsDataURL(n.files[0])) : u.indexOf("SAFARI") > -1 && alert("不支持Safari6.0以下浏览器的图片预览!") : u.indexOf("MSIE") > -1 ? u.indexOf("MSIE 6") > -1 ? document.getElementById(t).setAttribute("src", n.value) : (n.select(), u.indexOf("MSIE 9") > -1 && n.blur(), r = document.getElementById(i + "New"), r == null && (r = document.createElement("div"), r.setAttribute("id", i + "New"), r.style.width = document.getElementById(t).width + "px", r.style.height = document.getElementById(t).height + "px", r.style.border = "solid 1px #d2e2e2"), r.style.filter = "progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod='scale',src='" + document.selection.createRange().text + "')", f = document.getElementById(i), f.parentNode.insertBefore(r, f), f.style.display = "none") : u.indexOf("FIREFOX") > -1 ? (s = parseFloat(u.toLowerCase().match(/firefox\/([\d.]+)/)[1]), s < 7 ? document.getElementById(t).setAttribute("src", n.files[0].getAsDataURL()) : document.getElementById(t).setAttribute("src", window.URL.createObjectURL(n.files[0]))) : document.getElementById(t).setAttribute("src", n.value) : (alert("仅支持" + o + "为后缀名的文件!"), n.value = "", u.indexOf("MSIE") > -1 && (n.select(), document.selection.clear())) } } function showTime(n, t) { var u = n == null ? new Date : n, f = u.getFullYear(), i = u.getMonth() + 1, r = u.getDate(); return i = i > 9 ? i : "0" + i, r = r > 9 ? r : "0" + r, eT = f + "-" + i + "-" + r, t != null && t != 0 ? TransDate(eT, t) : eT } function TransDate(n, t) { var r = "", u = "", f = "", i; return r = n.replace("-", "/").replace("-", "/"), i = new Date(r), i = i.valueOf(), i = i + t * 864e5, i = new Date(i), u = (i.getMonth() + 1).toString().length == 1 ? "0" + (i.getMonth() + 1).toString() : (i.getMonth() + 1).toString(), f = i.getDate().toString().length == 1 ? "0" + i.getDate().toString() : i.getDate().toString(), i.getFullYear() + "-" + u + "-" + f } function eventStopProp(n) { var t = window.event || n.callee.caller.arguments[0]; t.stopPropagation() } function GetQueryString(n) { var i = new RegExp("(^|&)" + n + "=([^&]*)(&|$)"), t = window.location.search.substr(1).match(i); return t != null ? unescape(t[2]) : null } function prefixChar(n, t, i) { return (Array(t).join(i) + n).slice(-t) } function go2Page(n) { n != null && n != "" && $.ajax({ url: "/Home/GetTabItem", type: "POST", data: { url: n }, success: function (n) { n.success ? parent.addNewTabItem(n.data) : $.messager.alert("错误", n.message) } }) } function GetUrlParms() { for (var i, u, f, r = {}, e = location.search.substring(1), t = e.split("&"), n = 0; n < t.length; n++)(i = t[n].indexOf("="), i != -1) && (u = t[n].substring(0, i), f = t[n].substring(i + 1), r[u] = unescape(f)); return r } function ajaxDownload(n, t, i) { if (n && t) { t = typeof t == "string" ? t : decodeURIComponent(jQuery.param(t)); var r = ""; jQuery.each(t.split("&"), function () { var n = this.split("="); r += '<input type="hidden" name="' + n[0] + '" value="' + n[1] + '" />' }); jQuery('<form action="' + n + '" method="' + (i || "post") + '">' + r + "<\/form>").appendTo("body").submit().remove() } } function previewImage(n, t) { var r, i; n && /image\//.test(n.type) && (n.type == "image/gif" ? (r = new moxie.file.FileReader, r.onload = function () { t(r.result); r.destroy(); r = null }, r.readAsDataURL(n.getSource())) : (i = new moxie.image.Image, i.onload = function () { i.downsize(150, 150); var n = i.type == "image/jpeg" ? i.getAsDataURL("image/jpeg", 80) : i.getAsDataURL(); t && t(n); i.destroy(); i = null }, i.load(n.getSource()))) } function json2formDataKeyValues(n) { function t(n, r) { var u, f, e, o; for (u in n) { if (f = "", f = r && typeof r == "string" ? `${r}[${u}]` : u, e = typeof n[u], n[u] instanceof Array) for (o = 0; o < n[u].length; o++)t(n[o], f); e === "object" ? t(n[u], f) : (e === "string" || e == "number" || e == "boolean") && i.push({ k: f, v: n[u] }) } } var i = []; return t(n, ""), i } function getRowIndexAttr(n) { var t = $(n).closest("tr.datagrid-row"); return parseInt(t.attr("datagrid-row-index")) } function getFeature(n) { var t = null; return $.ajax({ url: "/Home/GetFeature", type: "post", "async": !1, data: { url: n }, success: n => { t = n.data } }), t } function OpenNewTab(n) { var r, t, i, u; if (arguments.length > 1) for (n += "?", r = arguments.length, t = 1; t < r; t++)n += `${arguments[t].k}=${arguments[t].v}`, t + 1 < r && (n += "$"); i = getFeature(n); i && (u = { id: i.id, name: i.title, href: n }, parent.addNewTabItem(u)) } function getGuid(n) { return n ? (n ^ Math.random() * 16 >> n / 4).toString(16) : ([1e7] + -1e3 + -4e3 + -8e3 + -1e11).replace(/[018]/g, b) } function stringToDate(n) { if (!n) return null; var t = n.split("-"); return t.length < 3 ? null : new Date(t[0], t[1] - 1, t[2], 0, 0, 0) } function fullScreen() { var t, i, n; (element = document.documentElement, (document.fullscreenEnabled || document.mozFullScreenEnabled || document.webkitFullscreenEnabled || document.msFullscreenEnabled || !1) != !1) && ((document.fullscreenElement || document.msFullscreenElement || document.mozFullScreenElement || document.webkitFullscreenElement || !1) == !1 ? (t = element.requestFullScreen || element.webkitRequestFullScreen || element.mozRequestFullScreen || element.msRequestFullScreen, t ? t.call(element) : typeof ActiveXObject != "undefined" && (n = new ActiveXObject("WScript.Shell"), n !== null && n.SendKeys("{F11}"))) : (i = document.exitFullscreen || document.mozCancelFullScreen || document.webkitExitFullscreen || document.webkitExitFullscreen, i ? i.call(document) : typeof ActiveXObject != "undefined" && (n = new ActiveXObject("WScript.Shell"), n !== null && n.SendKeys("{F11}")))) } function isFullScreen() { return document.fullscreenElement || document.msFullscreenElement || document.mozFullScreenElement || document.webkitFullscreenElement || !1 } $.ajaxSetup({ error: function (n) { errorHandler(n) } }); Date.prototype.DateDiff = function (n, t) { var i = this; switch (n) { case "s": return parseInt((t - i) / 1e3); case "n": return parseInt((t - i) / 6e4); case "h": return parseInt((t - i) / 36e5); case "d": return parseInt((t - i) / 864e5); case "w": return parseInt((t - i) / 6048e5); case "m": return t.getMonth() + 1 + (t.getFullYear() - i.getFullYear()) * 12 - (i.getMonth() + 1); case "y": return t.getFullYear() - i.getFullYear() } }; Date.prototype.dateAdd = function (n, t) { var r = this, i = { y: "FullYear", q: "Month", m: "Month", w: "Date", d: "Date", h: "Hours", n: "Minutes", s: "Seconds", ms: "MilliSeconds" }; return eval("d.set" + i[n] + "(d.get" + i[n] + "()+" + ({ q: 3, w: 7 }[n] || 1) * t + ")"), r }; Date.prototype.format = function (n) { var i = { "M+": this.getMonth() + 1, "d+": this.getDate(), "h+": this.getHours(), "m+": this.getMinutes(), "s+": this.getSeconds(), "q+": Math.floor((this.getMonth() + 3) / 3), S: this.getMilliseconds() }, t; /(y+)/.test(n) && (n = n.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length))); for (t in i) new RegExp("(" + t + ")").test(n) && (n = n.replace(RegExp.$1, RegExp.$1.length == 1 ? i[t] : ("00" + i[t]).substr(("" + i[t]).length))); return n }; Array.prototype.del = function (n) { return n < 0 ? this : this.slice(0, n).concat(this.slice(n + 1, this.length)) }; Array.prototype.clear = function () { this.length = 0 }; Array.prototype.indexOf || (Array.prototype.indexOf = function (n, t) { var r, f, u, i; if (this == null) throw new TypeError('"this" is null or not defined'); if ((f = Object(this), u = f.length >>> 0, u === 0) || (i = +t || 0, Math.abs(i) === Infinity && (i = 0), i >= u)) return -1; for (r = Math.max(i >= 0 ? i : u - Math.abs(i), 0); r < u;) { if (r in f && f[r] === n) return r; r++ } return -1 }); Array.prototype.Contain = function (n) { return this.indexOf(n) !== -1 }; var __ishow = !1; String.prototype.formating = function () { if (!this) return this; var n = this; return n = n.replace(/&lt;/g, "<"), n = n.replace(/&gt;/g, ">"), n = n.replace(/&quot;/g, '"'), n = n.replace(/&#39;/g, "'"), n.replace(/&br;/g, "\n") }; String.prototype.IsGuid = function () { if (!this) return !1; var n = this, t = new RegExp("[0-9a-z]{8}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{12}"); return t.test(n) }; typeof msgBoxN != "undefined" && (window.alert = function (n, t, i, r) { GoTop(); msgBoxN(n, t, i, r) }); msgBox = function (n, t, i, r) { GoTop(); msgBoxN(n, t, i, r) }; $(function () { var n, t, i; $("input,textarea").attr("spellcheck", "false"); $(".a-partital").on("click", function (n) { href = $(n.target).closest("a").attr("href").replace(/.*(?=#[^\s]*$)/, "").replace("#", ""); $("#ifrChild").attr("src", href + "?random=" + Math.random()); GoTop() }); n = window.document.location.toString().indexOf("#"); n > 0 && (t = window.document.location, i = t.toString().substr(n), i.length > 1 && ($('ul li>a[href="' + i + '"]').closest("li").addClass("active"), $("#ifrChild").attr("src", t.toString().substr(n + 1) + "?random=" + Math.random()), GoTop())); $(".xiala_menu").click(function () { var i = $(".xiala_menu").not($(this)[0]), t, n; if (i.size() > 0) for (t = 0; t < i.length; t++)n = i.eq(t).next(".xiala_con"), n.is(":hidden") || (n.hide(), i.eq(t).removeClass("hout_menuh")); n = $(this).next(".xiala_con"); n.is(":hidden") ? (n.show(), $(this).addClass("hout_menuh")) : (n.hide(), $(this).removeClass("hout_menuh")) }) }); const defaultImageUrl ="/Content/image/defoultImage.png";Number.prototype.toUpper=function(t="元"){money=this;var f=["零","壹","贰","叁","肆","伍","陆","柒","捌","玖"],h=["","拾","佰","仟"],c=["","万","亿","兆"],l=["角","分","毫","厘"],o="整",e,u,r="",s;if(money=="")return"";if(money=parseFloat(money),money>=1e15)return console.log("超出最大处理数字"),"";if(money==0)return f[0]+t+o;if(money=money.toString(),money.indexOf(".")==-1?(e=money,u=""):(s=money.split("."),e=s[0],u=s[1].substr(0,4)),parseInt(e,10)>0){for(zeroCount=0,IntLen=e.length,i=0;i<IntLen;i++)n=e.substr(i,1),p=IntLen-i-1,q=p/4,m=p%4,n=="0"?zeroCount++:(zeroCount>0&&(r+=f[0]),zeroCount=0,r+=f[parseInt(n)]+h[m]),m==0&&zeroCount<4&&(r+=c[q]);r+=t}if(u!="")for(decLen=u.length,i=0;i<decLen;i++)n=u.substr(i,1),n!="0"&&(r+=f[Number(n)]+l[i]);return r==""?r+=f[0]+t+o:u==""&&(r+=o),r};